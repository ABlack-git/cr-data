---
title: "eu_funds"
output: html_document
date: '2022-07-04'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
```

```{r}
funds_2013 <- read.csv('raw_data/EU_funds_2007_2013.csv',  colClasses = c("IČ.žadatele"="character"))
funds_2020 <- read.csv('raw_data/EU_funds_2014_2020.csv', colClasses = c("Identification.number.of.the.beneficiary"="character"))
```

```{r}
funds_2013$Datum.podpisu.smlouvy.rozhodnutí <- as.Date(funds_2013$Datum.podpisu.smlouvy.rozhodnutí)
funds_2013 <- funds_2013 %>% mutate(year=format(Datum.podpisu.smlouvy.rozhodnutí, "%Y"))
summary(funds_2013)
funds_2013 <- funds_2013[,c("IČ.žadatele", "year", "Proplacené.prostředky.příjemcům...vyúčtované..veřejné.prostředky.celkem.","Proplacené.prostředky.příjemcům...vyúčtované..EU.zdroje.")]
funds_2013 <- na.omit(funds_2013)
funds_2013_grouped <- funds_2013 %>% group_by(year, `IČ.žadatele`) %>% 
  summarise(
    Proplacené.prostředky.příjemcům...vyúčtované..veřejné.prostředky.celkem. = sum(Proplacené.prostředky.příjemcům...vyúčtované..veřejné.prostředky.celkem.),
    Proplacené.prostředky.příjemcům...vyúčtované..EU.zdroje. = sum(Proplacené.prostředky.příjemcům...vyúčtované..EU.zdroje.)
  )
write.csv(funds_2013_grouped, "funds_2013_grouped.csv")
```


```{r}

funds_2020$...10 <- as.Date(funds_2020$...10)
funds_2020 <- funds_2020 %>% mutate(year=format(...10, "%Y"))
summary(funds_2020)
funds_2020 <- funds_2020[,c("Identification.number.of.the.beneficiary", "year", "Total.eligible.expenditures.charged.in.payment.applications", "Expenditures.charged.in.payment.application...Union.support")]
funds_2020 <- na.omit(funds_2020)
funds_2020_grouped <- funds_2020 %>% group_by(year, `Identification.number.of.the.beneficiary`) %>%
  summarise(
    Total.eligible.expenditures.charged.in.payment.applications = sum(Total.eligible.expenditures.charged.in.payment.applications),
    Expenditures.charged.in.payment.application...Union.support = sum(Expenditures.charged.in.payment.application...Union.support)
  )

write.csv(funds_2020_grouped, "funds_2020_grouped.csv")
```